{
	"name": "Estimated - All Offenses DataFlow - Region",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ArrestsAllOffensesSourceRegionEstimated",
						"type": "DatasetReference"
					},
					"name": "AllArrestsDataSource"
				},
				{
					"dataset": {
						"referenceName": "areaDataSource",
						"type": "DatasetReference"
					},
					"name": "Area"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ArrestAllOffensesDestination",
						"type": "DatasetReference"
					},
					"name": "UpdateDB"
				}
			],
			"transformations": [
				{
					"name": "RemoveNA"
				},
				{
					"name": "ConvertDataType"
				},
				{
					"name": "JoinWithAREA"
				},
				{
					"name": "RegionOnly"
				}
			],
			"script": "parameters{\n\tisReported as integer (0)\n}\nsource(output(\n\t\tProp_0 as string,\n\t\tREGION as string,\n\t\tYEAR as string,\n\t\tPOP as string,\n\t\tTotal_Arrests as string,\n\t\tPart1_Arrests as string,\n\t\tPart2_Arrests as string,\n\t\tViolent_Arrests as string,\n\t\tProperty_Arrests as string,\n\t\tHomicide_Arrests as string,\n\t\tRape_Arrests as string,\n\t\tRobbery_Arrests as string,\n\t\tAggAssault_Arrests as string,\n\t\tBurglary_Arrests as string,\n\t\tLarceny_Arrests as string,\n\t\tMotorVehicleTheft_Arrests as string,\n\t\tSimpleAssault_Arrests as string,\n\t\tArson_Arrests as string,\n\t\tForgeryCounterfeit_Arrests as string,\n\t\tFraud_Arrests as string,\n\t\tEmbezzlement_Arrests as string,\n\t\tStolenProp_Arrests as string,\n\t\tVandalism_Arrests as string,\n\t\tWeapons_Arrests as string,\n\t\tProstitution_Arrests as string,\n\t\tSexOffense_Arrests as string,\n\t\tDrugAbuse_Arrests as string,\n\t\tGambling_Arrests as string,\n\t\tFamilyChildren_Arrests as string,\n\t\tDUI_Arrests as string,\n\t\tLiquor_Arrests as string,\n\t\tDrunkeness_Arrests as string,\n\t\tDisorderly_Arrests as string,\n\t\tVagrancy_Arrests as string,\n\t\tOther_Arrests as string,\n\t\tSuspicion_Arrests as string,\n\t\tCurfewLoitering_Arrests as string,\n\t\tRunaways_Arrests as string,\n\t\tPOP_TOTAL as string,\n\t\tPOP_UNDER18 as string,\n\t\tPOP_OVER18 as string,\n\t\tPOP_MALE as string,\n\t\tPOP_FEMALE as string,\n\t\tPOP_AGE_0_9 as string,\n\t\tPOP_M0_9 as string,\n\t\tPOP_F0_9 as string,\n\t\tPOP_AGE_10_12 as string,\n\t\tPOP_M10_12 as string,\n\t\tPOP_F10_12 as string,\n\t\tPOP_AGE_13_15 as string,\n\t\tPOP_M13_15 as string,\n\t\tPOP_F13_15 as string,\n\t\tPOP_AGE_16_17 as string,\n\t\tPOP_M16_17 as string,\n\t\tPOP_F16_17 as string,\n\t\tPOP_AGE_18_24 as string,\n\t\tPOP_M18_24 as string,\n\t\tPOP_F18_24 as string,\n\t\tPOP_AGE_25_29 as string,\n\t\tPOP_M25_29 as string,\n\t\tPOP_F25_29 as string,\n\t\tPOP_AGE_30_34 as string,\n\t\tPOP_M30_34 as string,\n\t\tPOP_F30_34 as string,\n\t\tPOP_AGE_35_39 as string,\n\t\tPOP_M35_39 as string,\n\t\tPOP_F35_39 as string,\n\t\tPOP_AGE_40_44 as string,\n\t\tPOP_M40_44 as string,\n\t\tPOP_F40_44 as string,\n\t\tPOP_AGE_45_49 as string,\n\t\tPOP_M45_49 as string,\n\t\tPOP_F45_49 as string,\n\t\tPOP_AGE_50_54 as string,\n\t\tPOP_M50_54 as string,\n\t\tPOP_F50_54 as string,\n\t\tPOP_AGE_55_59 as string,\n\t\tPOP_M55_59 as string,\n\t\tPOP_F55_59 as string,\n\t\tPOP_AGE_60_64 as string,\n\t\tPOP_M60_64 as string,\n\t\tPOP_F60_64 as string,\n\t\tPOP_AGE_65_85 as string,\n\t\tPOP_M65_85 as string,\n\t\tPOP_F65_85 as string,\n\t\tPOP_WHITE as string,\n\t\tPOP_JW as string,\n\t\tPOP_AW as string,\n\t\tPOP_BLACK as string,\n\t\tPOP_JB as string,\n\t\tPOP_AB as string,\n\t\tPOP_ASIAN as string,\n\t\tPOP_JA as string,\n\t\tPOP_AA as string,\n\t\tPOP_NATIVE as string,\n\t\tPOP_JI as string,\n\t\tPOP_AI as string,\n\t\tPOP_HISPANIC as string,\n\t\tPOP_JH as string,\n\t\tPOP_AH as string,\n\t\tPOP_NON_HISPANIC as string,\n\t\tPOP_JN as string,\n\t\tPOP_AN as string\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> AllArrestsDataSource\nsource(output(\n\t\tAreaId as integer,\n\t\tAreaTypeId as integer,\n\t\tRegionId as integer,\n\t\tStateId as integer,\n\t\tFips as integer,\n\t\tAreaName as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> Area\nAllArrestsDataSource filter(YEAR != 'NA' && YEAR != 'na' && REGION != 'NA' && REGION != 'na') ~> RemoveNA\nRemoveNA derive(REGIONNAME = upper(REGION),\n\t\tTOTALARRESTS = case(lower(Total_Arrests) == 'na', 0, case(toInteger(Total_Arrests) < 0 , 0, toInteger(Total_Arrests))),\n\t\tPARTIARRESTS = case(lower(Part1_Arrests) == 'na', 0, case(toInteger(Part1_Arrests) < 0 , 0, toInteger(Part1_Arrests))),\n\t\tPARTIIARRESTS = case(lower(Part2_Arrests) == 'na', 0, case(toInteger(Part2_Arrests) < 0 , 0, toInteger(Part2_Arrests))),\n\t\tVIOLENTARRESTS = case(lower(Violent_Arrests) == 'na', 0, case(toInteger(Violent_Arrests) < 0 , 0, toInteger(Violent_Arrests))),\n\t\tPROPERTYARRESTS = case(lower(Property_Arrests) == 'na', 0, case(toInteger(Property_Arrests) < 0 , 0, toInteger(Property_Arrests))),\n\t\tHOMICIDEARRESTS = case(lower(Homicide_Arrests) == 'na', 0, case(toInteger(Homicide_Arrests) < 0 , 0, toInteger(Homicide_Arrests))),\n\t\tRAPEARRESTS = case(lower(Rape_Arrests) == 'na', 0, case(toInteger(Rape_Arrests) < 0 , 0, toInteger(Rape_Arrests))),\n\t\tROBBERYARRESTS = case(lower(Robbery_Arrests) == 'na', 0, case(toInteger(Robbery_Arrests) < 0 , 0, toInteger(Robbery_Arrests))),\n\t\tAGGASSULTARRESTS = case(lower(AggAssault_Arrests) == 'na', 0, case(toInteger(AggAssault_Arrests) < 0 , 0, toInteger(AggAssault_Arrests))),\n\t\tBURGALARYARRESTS = case(lower(Burglary_Arrests) == 'na', 0, case(toInteger(Burglary_Arrests) < 0 , 0, toInteger(Burglary_Arrests))),\n\t\tLARCENYARRESTS = case(lower(Larceny_Arrests) == 'na', 0, case(toInteger(Larceny_Arrests) < 0 , 0, toInteger(Larceny_Arrests))),\n\t\tMOTORVEHICLEARRESTS = case(lower(MotorVehicleTheft_Arrests) == 'na', 0, case(toInteger(MotorVehicleTheft_Arrests) < 0 , 0, toInteger(MotorVehicleTheft_Arrests))),\n\t\tASSAULTARRESTS = case(lower(SimpleAssault_Arrests) == 'na', 0, case(toInteger(SimpleAssault_Arrests) < 0 , 0, toInteger(SimpleAssault_Arrests))),\n\t\tARSONARRESTS = case(lower(Arson_Arrests) == 'na', 0, case(toInteger(Arson_Arrests) < 0 , 0, toInteger(Arson_Arrests))),\n\t\tFORGERYARRESTS = case(lower(ForgeryCounterfeit_Arrests) == 'na', 0, case(toInteger(ForgeryCounterfeit_Arrests) < 0 , 0, toInteger(ForgeryCounterfeit_Arrests))),\n\t\tFRAUDARRESTS = case(lower(Fraud_Arrests) == 'na', 0, case(toInteger(Fraud_Arrests) < 0 , 0, toInteger(Fraud_Arrests))),\n\t\tEMBEZZLEMENTARRESTS = case(lower(Embezzlement_Arrests) == 'na', 0, case(toInteger(Embezzlement_Arrests) < 0 , 0, toInteger(Embezzlement_Arrests))),\n\t\tSTOLENPROPARRESTS = case(lower(StolenProp_Arrests) == 'na', 0, case(toInteger(StolenProp_Arrests) < 0 , 0, toInteger(StolenProp_Arrests))),\n\t\tVANDALISMARRESTS = case(lower(Vandalism_Arrests) == 'na', 0, case(toInteger(Vandalism_Arrests) < 0 , 0, toInteger(Vandalism_Arrests))),\n\t\tWEAPONSARRESTS = case(lower(Weapons_Arrests) == 'na', 0, case(toInteger(Weapons_Arrests) < 0 , 0, toInteger(Weapons_Arrests))),\n\t\tPROSTITUTIONARRESTS = case(lower(Prostitution_Arrests) == 'na', 0, case(toInteger(Prostitution_Arrests) < 0 , 0, toInteger(Prostitution_Arrests))),\n\t\tSEXOFFENSESARRESTS = case(lower(SexOffense_Arrests) == 'na', 0, case(toInteger(SexOffense_Arrests) < 0 , 0, toInteger(SexOffense_Arrests))),\n\t\tDRUGABUSEARRESTS = case(lower(DrugAbuse_Arrests) == 'na', 0, case(toInteger(DrugAbuse_Arrests) < 0 , 0, toInteger(DrugAbuse_Arrests))),\n\t\tGAMBLINGARRESTS = case(lower(Gambling_Arrests) == 'na', 0, case(toInteger(Gambling_Arrests) < 0 , 0, toInteger(Gambling_Arrests))),\n\t\tFAMILYCHILDRENARRESTS = case(lower(FamilyChildren_Arrests) == 'na', 0, case(toInteger(FamilyChildren_Arrests) < 0 , 0, toInteger(FamilyChildren_Arrests))),\n\t\tDUIARRESTS = case(lower(DUI_Arrests) == 'na', 0, case(toInteger(DUI_Arrests) < 0 , 0, toInteger(DUI_Arrests))),\n\t\tLIQUORARRESTS = case(lower(Liquor_Arrests) == 'na', 0, case(toInteger(Liquor_Arrests) < 0 , 0, toInteger(Liquor_Arrests))),\n\t\tDRUNKENESSARRESTS = case(lower(Drunkeness_Arrests) == 'na', 0, case(toInteger(Drunkeness_Arrests) < 0 , 0, toInteger(Drunkeness_Arrests))),\n\t\tDISORDERLYARRESTS = case(lower(Disorderly_Arrests) == 'na', 0, case(toInteger(Disorderly_Arrests) < 0 , 0, toInteger(Disorderly_Arrests))),\n\t\tVAGRANCYARRESTS = case(lower(Vagrancy_Arrests) == 'na', 0, case(toInteger(Vagrancy_Arrests) < 0 , 0, toInteger(Vagrancy_Arrests))),\n\t\tOTHERARRESTS = case(lower(Other_Arrests) == 'na', 0, case(toInteger(Other_Arrests) < 0 , 0, toInteger(Other_Arrests))),\n\t\tSUSPICIONARRESTS = case(lower(Suspicion_Arrests) == 'na', 0, case(toInteger(Suspicion_Arrests) < 0 , 0, toInteger(Suspicion_Arrests))),\n\t\tCURFEWLOITERINGARRESTS = case(lower(CurfewLoitering_Arrests) == 'na', 0, case(toInteger(CurfewLoitering_Arrests) < 0 , 0, toInteger(CurfewLoitering_Arrests))),\n\t\tRUNAWAYSARRESTS = case(lower(Runaways_Arrests) == 'na', 0, case(toInteger(Runaways_Arrests) < 0 , 0, toInteger(Runaways_Arrests))),\n\t\tFORMATTEDYEAR = toInteger(YEAR),\n\t\tTOTALPOPULATION = case(lower(POP_TOTAL) == 'na', 0, case(toInteger(POP_TOTAL) < 0 , 0, toInteger(POP_TOTAL))),\n\t\tAVERAGEMONTHREPORTED = 0,\n\t\tISREPORTED = $isReported,\n\t\tORI7 = \"\",\n\t\tYEAR_CONVERTED = toInteger(YEAR),\n\t\tSIMPLEASSAULTARRESTS = case(lower(SimpleAssault_Arrests) == 'na', 0, case(toInteger(SimpleAssault_Arrests) < 0 , 0, toInteger(SimpleAssault_Arrests)))) ~> ConvertDataType\nConvertDataType, RegionOnly join(upper(REGIONNAME) == upper(AreaName),\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> JoinWithAREA\nArea filter(AreaTypeId == 2) ~> RegionOnly\nJoinWithAREA sink(input(\n\t\tYear as integer,\n\t\tAreaId as integer,\n\t\tAreaTypeId as integer,\n\t\tIsReported as boolean,\n\t\tFips as integer,\n\t\tORI7 as string,\n\t\tTotalPopulation as integer,\n\t\tAverageMonthOfDataReported as double,\n\t\tAllOffenses as integer,\n\t\tPartI as integer,\n\t\tPartII as integer,\n\t\tViolent as integer,\n\t\tAggravatedAssault as integer,\n\t\tHomicide as integer,\n\t\tRape as integer,\n\t\tRobbery as integer,\n\t\tProperty as integer,\n\t\tArson as integer,\n\t\tBurglary as integer,\n\t\tLarceny as integer,\n\t\tMotorVehicleTheft as integer,\n\t\tCurfewLoitering as integer,\n\t\tDisorderlyConduct as integer,\n\t\tDrivingUnderTheInfluence as integer,\n\t\tDrugAbuse as integer,\n\t\tDrunkenness as integer,\n\t\tEmbezzlement as integer,\n\t\tForgeryCounterfeiting as integer,\n\t\tFraud as integer,\n\t\tGambling as integer,\n\t\tLiquorLaws as integer,\n\t\tOffensesAgainstFamilyChildren as integer,\n\t\tOtherNonTrafficOffenses as integer,\n\t\tProstitution as integer,\n\t\tRunaway as integer,\n\t\tSexOffense as integer,\n\t\tSimpleAssault as integer,\n\t\tStolenProperty as integer,\n\t\tSuspicion as integer,\n\t\tVagrancy as integer,\n\t\tVandalism as integer,\n\t\tWeapons as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tYear = YEAR_CONVERTED,\n\t\tAreaId,\n\t\tAreaTypeId,\n\t\tIsReported = ISREPORTED,\n\t\tFips,\n\t\tORI7,\n\t\tTotalPopulation = TOTALPOPULATION,\n\t\tAverageMonthOfDataReported = AVERAGEMONTHREPORTED,\n\t\tAllOffenses = TOTALARRESTS,\n\t\tPartI = PARTIARRESTS,\n\t\tPartII = PARTIIARRESTS,\n\t\tViolent = VIOLENTARRESTS,\n\t\tAggravatedAssault = AGGASSULTARRESTS,\n\t\tHomicide = HOMICIDEARRESTS,\n\t\tRape = RAPEARRESTS,\n\t\tRobbery = ROBBERYARRESTS,\n\t\tProperty = PROPERTYARRESTS,\n\t\tArson = ARSONARRESTS,\n\t\tBurglary = BURGALARYARRESTS,\n\t\tLarceny = LARCENYARRESTS,\n\t\tMotorVehicleTheft = MOTORVEHICLEARRESTS,\n\t\tCurfewLoitering = CURFEWLOITERINGARRESTS,\n\t\tDisorderlyConduct = DISORDERLYARRESTS,\n\t\tDrivingUnderTheInfluence = DUIARRESTS,\n\t\tDrugAbuse = DRUGABUSEARRESTS,\n\t\tDrunkenness = DRUNKENESSARRESTS,\n\t\tEmbezzlement = EMBEZZLEMENTARRESTS,\n\t\tForgeryCounterfeiting = FORGERYARRESTS,\n\t\tFraud = FRAUDARRESTS,\n\t\tGambling = GAMBLINGARRESTS,\n\t\tLiquorLaws = LIQUORARRESTS,\n\t\tOffensesAgainstFamilyChildren = FAMILYCHILDRENARRESTS,\n\t\tOtherNonTrafficOffenses = OTHERARRESTS,\n\t\tProstitution = PROSTITUTIONARRESTS,\n\t\tRunaway = RUNAWAYSARRESTS,\n\t\tSexOffense = SEXOFFENSESARRESTS,\n\t\tSimpleAssault = SIMPLEASSAULTARRESTS,\n\t\tStolenProperty = STOLENPROPARRESTS,\n\t\tSuspicion = SUSPICIONARRESTS,\n\t\tVagrancy = VAGRANCYARRESTS,\n\t\tVandalism = VANDALISMARRESTS,\n\t\tWeapons = WEAPONSARRESTS\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> UpdateDB"
		}
	}
}